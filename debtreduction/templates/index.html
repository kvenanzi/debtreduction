<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Debt Reduction Planner</title>
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/tailwindcss@3.4.1/dist/tailwind.min.css"
    />
    <link rel="stylesheet" href="/static/css/styles.css" />
  </head>
  <body class="app-body">
    <div class="app-shell">
      <main class="sheet">
        <header class="sheet-header">
          <h1 class="sheet-title">Debt Reduction Calculator</h1>
          <p class="sheet-subtitle">
            Enter your balances, rates, and monthly budget to visualise payoff timelines using
            Avalanche, Snowball, Entered Order, or Custom strategies.
          </p>
          <div id="congrats-banner" class="celebration-banner hidden">
            <div class="celebration-confetti" aria-hidden="true">ðŸŽ‰</div>
            <div>
              <p class="celebration-title">Congratulations!</p>
              <p class="celebration-body">
                You've paid off <span id="congrats-count">0</span>
                <span class="celebration-plural">loans</span>. Amazing progress!
              </p>
            </div>
          </div>
          <div class="strategy-chip">Strategy: <span id="strategy-label">Avalanche (Highest APR First)</span></div>
          <div id="notification" class="notification hidden"></div>
        </header>

        <section class="sheet-grid">
          <aside class="space-y-5">
            <section class="panel">
              <h2>Balance Date &amp; Budget</h2>
              <form id="settings-form" class="space-y-4">
                <div class="form-control">
                  <label for="balanceDate">Balance Date</label>
                  <input id="balanceDate" type="date" name="balanceDate" required class="input-field" />
                </div>
                <div class="form-control">
                  <label for="monthlyBudget">Monthly Payment</label>
                  <div class="currency-input">
                    <span class="currency-prefix">$</span>
                    <input
                      id="monthlyBudget"
                      type="text"
                      name="monthlyBudget"
                      min="0"
                      step="0.01"
                      required
                      class="input-field currency-field"
                    />
                  </div>
                  <button type="button" id="reset-budget" class="btn-reset">Reset to minimum</button>
                </div>
                <div class="form-control">
                  <label for="strategy">Strategy</label>
                  <select id="strategy" name="strategy" class="input-field">
                    <option value="avalanche">Avalanche (Highest APR First)</option>
                    <option value="snowball">Snowball (Lowest Balance First)</option>
                    <option value="entered">Entered Order</option>
                    <option value="custom">Custom Priority</option>
                  </select>
                </div>
                <button type="submit" class="btn-primary">Save Settings</button>
              </form>
            </section>

            <section class="panel">
              <h2>Payment Snapshot</h2>
              <div class="stat-grid">
                <article class="stat-tile">
                  <h3>Monthly Payment</h3>
                  <p id="monthly-budget-display">$0.00</p>
                </article>
                <article class="stat-tile">
                  <h3>Minimum Monthly Payment</h3>
                  <p id="min-payments">$0.00</p>
                </article>
                <article class="stat-tile">
                  <h3>Initial Snowball</h3>
                  <p id="initial-snowball">$0.00</p>
                </article>
              </div>
            </section>

            <section class="panel">
              <h2>Add Creditor</h2>
              <form id="debt-form" class="grid grid-cols-1 gap-4">
                <div class="form-control">
                  <label for="creditor">Creditor</label>
                  <input id="creditor" name="creditor" required class="input-field" />
                </div>
                <div class="grid grid-cols-2 gap-3">
                  <div class="form-control">
                    <label for="balance">Balance ($)</label>
                    <input
                      id="balance"
                      type="number"
                      step="0.01"
                      min="0"
                      name="balance"
                      required
                      class="input-field"
                    />
                  </div>
                  <div class="form-control">
                    <label for="apr">Rate (%)</label>
                    <input
                      id="apr"
                      type="number"
                      step="0.01"
                      min="0"
                      name="apr"
                      required
                      class="input-field"
                    />
                  </div>
                </div>
                <div class="grid grid-cols-2 gap-3">
                  <div class="form-control">
                    <label for="minimumPayment">Payment ($)</label>
                    <input
                      id="minimumPayment"
                      type="number"
                      step="0.01"
                      min="0"
                      name="minimumPayment"
                      required
                      class="input-field"
                    />
                  </div>
                  <div class="form-control">
                    <label for="customPriority">Custom Priority</label>
                    <input
                      id="customPriority"
                      type="number"
                      step="1"
                      min="1"
                      name="customPriority"
                      class="input-field"
                    />
                  </div>
                </div>
                <button type="submit" class="btn-accent">Add Debt</button>
              </form>
            </section>
          </aside>

          <section class="space-y-5">
            <section class="panel">
              <h2>Debts in Chosen Order</h2>
              <div class="overflow-x-auto">
                <table class="data-table text-sm">
                  <thead>
                    <tr>
                      <th>Creditor</th>
                      <th>Original Balance</th>
                      <th>Interest Paid</th>
                      <th>Current Balance</th>
                      <th>Months to Pay Off</th>
                      <th>Month Paid Off</th>
                    </tr>
                  </thead>
                  <tbody id="summary-table"></tbody>
                </table>
              </div>
              <div class="table-footer">
                <span>Total Interest Paid: <span id="summary-total-interest">$0.00</span></span>
                <span>Debt Free: <span id="summary-debt-free">â€”</span></span>
              </div>
            </section>

            <div class="stat-grid">
              <article class="summary-card">
                <h3>Total Payoff Months</h3>
                <p id="total-months">0</p>
              </article>
              <article class="summary-card">
                <h3>Total Interest Paid</h3>
                <p id="total-interest">$0.00</p>
              </article>
              <article class="summary-card">
                <h3>Debts Count</h3>
                <p id="debts-count">0</p>
              </article>
              <article class="summary-card">
                <h3>Debt Free Month</h3>
                <p id="debt-free-date">â€”</p>
              </article>
            </div>

            <div class="tab-bar">
              <button class="tab-btn is-active" data-target="overview-tab">Overview</button>
              <button class="tab-btn" data-target="schedule-tab">Payment Schedule</button>
            </div>

            <div id="overview-tab" class="tab-group is-active">
              <section class="panel">
                <div class="flex flex-col gap-2 md:flex-row md:items-center md:justify-between">
                  <h2>Cumulative Balance Trend</h2>
                  <p class="text-sm text-slate-500">
                    Tracks total outstanding principal across all debts by month.
                  </p>
                </div>
                <canvas id="balance-chart" height="220"></canvas>
              </section>

              <section class="panel">
                <div class="flex flex-col gap-2 md:flex-row md:items-center md:justify-between">
                  <h2>Snowball Growth Chart</h2>
                  <p class="text-sm text-slate-500">
                    Bars show your rolling snowball payment. The line tracks interest accrued each month.
                  </p>
                </div>
                <canvas id="snowball-chart" height="220"></canvas>
              </section>

              <section class="panel">
                <div class="flex items-center justify-between flex-wrap gap-3">
                  <h2>Creditor Information Table</h2>
                </div>
                <div class="overflow-x-auto">
                  <table class="data-table text-sm">
                    <thead>
                      <tr>
                        <th class="w-12">Row</th>
                        <th>Creditor</th>
                        <th>Balance</th>
                        <th>Rate</th>
                        <th>Payment</th>
                        <th>Custom</th>
                        <th>Actions</th>
                      </tr>
                    </thead>
                    <tbody id="debts-table"></tbody>
                  </table>
                </div>
              </section>
            </div>

            <div id="schedule-tab" class="tab-group">
              <section class="panel">
                <div class="flex flex-col gap-2 md:flex-row md:items-center md:justify-between">
                  <h2>Payment Schedule</h2>
                  <p class="text-sm text-slate-500">
                    Adjust the additional payment column to model extra payoff each month, and record the actual payments you made when they differ from the plan.
                  </p>
                </div>
                <div class="overflow-x-auto">
                  <table class="data-table text-xs md:text-sm">
                    <thead id="schedule-head"></thead>
                    <tbody id="schedule-body"></tbody>
                  </table>
                </div>
                <p class="schedule-note">Results are estimates and assume monthly compounding.</p>
              </section>
            </div>
          </section>
        </section>
      </main>
    </div>

    <div
      id="actuals-modal"
      class="modal hidden"
      role="dialog"
      aria-modal="true"
      aria-labelledby="actuals-modal-title"
    >
      <div class="modal-panel" role="document">
        <div class="modal-header">
          <h3 id="actuals-modal-title">Actual Payments</h3>
          <button type="button" class="modal-close" data-dismiss="actuals-modal" aria-label="Close">
            &times;
          </button>
        </div>
        <form id="actuals-form" class="modal-body">
          <input type="hidden" id="actuals-month-index" name="monthIndex" />
          <p class="modal-intro">
            Enter the amounts you actually paid for the selected month. Leave values as-is to keep the simulated plan.
          </p>
          <div id="actuals-list" class="actuals-list"></div>
          <div class="modal-footer">
            <button type="button" id="actuals-clear" class="modal-link">Clear overrides</button>
            <div class="modal-actions">
              <button type="button" class="btn-action" data-dismiss="actuals-modal">Cancel</button>
              <button type="submit" class="btn-primary">Save actuals</button>
            </div>
          </div>
        </form>
      </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js"></script>
    <script src="/static/js/app.js" type="module"></script>
  </body>
</html>
